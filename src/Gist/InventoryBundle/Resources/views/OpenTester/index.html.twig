{% extends "GistTemplateBundle::base.html.twig" %}
{% import "GistTemplateBundle::form.html.twig" as form_tools %}
{% block content %}
    <!-- CONTENT -->
    <div class="row">
        <div class="col-12">
            <h2 class="page-title">Open Tester</h2>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="d-inline-block">
                <a href="{{ path('gist_inv_open_tester_add_entries_form') }}" class="btn btn-primary btn-v1 mr-3 mt-3 mb-3">+ Add New</a>
            </div>
            <div class="d-inline-block">
                <button class="btn btn-success btn-v1 mr-3 mt-3 mb-3" data-toggle="modal" data-target="#searchProduct">View Summary</button>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <div class="table-responsive table-v1">
                <table id="table--submitted_counting" class="table table-bordered" data-data-table="true" style="width:100%">
                    <thead>
                    <tr>
                        <th style="width: 18%">Item</th>
                        <th style="width: 11%">Date Opened</th>
                        <th style="width: 12%">Created By</th>
                        <th style="width: 12%">Date Consumed</th>
                        <th style="width: 12%">Last Update By</th>
                        <th style="width: 10%">Status</th>
                        <th style="width: 8%">Picked-Up</th>
                        <th style="width: 8%">Consume</th>
                        <th style="width: 8%">Pick-up</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for s in dmg_stocks|default('') %}
                        <tr>
                            <td>{{ s.item_name }}</td>
                            <td>{{ s.date_create }}</td>
                            <td>{{ s.user_create }}</td>
                            <td>{{ s.date_consumed }}</td>
                            <td>{{ s.user_consumed }}</td>
                            <td>{{ s.statusFMTD }}</td>
                            {% if s.flag_pickedup == true %}
                                <td class="text-center"><i class="fas fa-check"></i></td>
                            {% else %}
                                <td class="text-center"><i class="fas fa-times"></i></td>
                            {% endif %}

                            {% if s.statusFMTD == 'Opened' %}
                                <td class="text-center"><a href="{{ path('gist_inv_open_tester_consume_item', { 'id': s.id }) }}"><i class="fas fa-edit"></i></a></td>
                            {% elseif s.statusFMTD == 'Consumed' %}
                                <td></td>
                            {% else %}
                                <td></td>
                            {% endif %}

                            {% if s.flag_pickedup == false and s.statusFMTD == 'Consumed' %}
                                <td class="text-center"><a href="{{ path('gist_inv_open_tester_pickup_item', { 'id': s.id }) }}"><i class="fas fa-truck" data-fa-transform="rotate-30"></i></a></td>
                            {% else %}
                                <td></td>
                            {% endif %}
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!-- END CONTENT -->
{% endblock %}
{% block modal %}
    <div class="modals">
        <div aria-hidden="true" aria-labelledby="searchProductLabel" class="modal modal--v1 fade " id="searchProduct" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Tester Summary</h5>
                    </div>
                    <div class="modal-body pt-0">
                        <div class="row">
                            <div class="col-12 col-lg-4">
                                <input type="text" class="input-v2 input-search w-100" placeholder="search">
                            </div>
                            <div class="col-12 col-lg-8 mt-2 mt-lg-0">
                                <div class="row">
                                    <div class="col-12 col-lg-8 d-flex flex-wrap justify-content-around align-items-center">
                                        <label for="" class="text-blue-1">Product Category:</label>
                                        <select name="" id="search--input_cat" class="input-v2" style="min-width: 175px;" placeholder="Product Category:">
                                            <option value="">All</option>
                                            <option value="">2</option>
                                            <option value="">1</option>
                                        </select>
                                    </div>
                                    <div class="col-12 col-lg-4 text-center text-lg-left">
                                        <button class="btn btn-v1 btn-primary btn-small" type="button">Apply Filter</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <div class="table-responsive table-v1">
                                    <table id="table--search" class="table table-bordered" data-data-table="true" style="width:100%" data-page-length="5">
                                        <thead>
                                        <tr>
                                            <th style="">Item</th>
                                            <th style="">Bar Code</th>
                                            <th style="">Name</th>
                                            <th style="">Quantity</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for s in summ %}
                                            <tr>
                                                <td>{{ s.item_code }}</td>
                                                <td>{{ s.barcode }}</td>
                                                <td>{{ s.item_name }}</td>
                                                <td>{{ s.quantity }}</td>
                                                {#<td class="text-center"><span class="text-blue-1"> <i class="fas fa-plus"></i> <a href="#!" class="text-underline">Add New</a></span></td>#}
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <button class="btn btn-v1 btn-success" data-dismiss="modal" type="button">Add Entry</button>
                            <button class="btn btn-v1 btn-secondary" data-dismiss="modal" type="button">Close</button>
                        </div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block js %}
    <script>
        jQuery(document).ready(function($) {
            dTable = $('#table--submitted_counting').dataTable({
                "bProcessing": true,
                "bServerSide": false,
                //"sAjaxSource": path,
                "iDisplayLength": 10,
                "bInfo": false,
                // "bSort" : false,
                // "bLengthChange": false,
                // "sPaginationType": "bootstrap",
                "oLanguage": {
                    "sLengthMenu": "_MENU_ records",
                    "oPaginate": {
                        "sPrevious": "<span class=\"prev-icon\"><i class=\"fas fa-chevron-left\"></i></span>",
                        "sNext": "<span class=\"next-icon\"><i class=\"fas fa-chevron-right\"></i></span>"
                    }
                },
                "aoColumnDefs": [
                    { "bSortable": false, "aTargets": [6,7,8] },
                ],
                "aaSorting": [[0,'desc']]
            });
        });
    </script>
{% endblock %}